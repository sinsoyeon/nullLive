<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Board">
	<resultMap type="Board" id="boardResultSet">
		<id property="bno" column="BNO"/>
		<result property="fno" column="FNO"/>
		<result property="snno" column="SNNO"/>
		<result property="bTitle" column="BTITLE"/>
		<result property="bContent" column="BCONTENT"/>
		<result property="writtenDate" column="WRITTEN_DATE"/>
		<result property="modifyDate" column="MODIFY_DATE"/>
		<result property="bCount" column="BCOUNT"/>
		<result property="bType" column="BTYPE"/>
		<result property="questionType" column="QUESTION_TYPE"/>
		<result property="refBno" column="REF_BNO"/>
		<result property="bEmail" column="B_EMAIL"/>
		<result property="bbno" column="BBNO"/>
		<result property="bWriter" column="BWRITER"/>
		<result property="reportType" column="REPORT_TYPE"/>
		<result property="isQr" column="IS_QR"/>
		<result property="reportMno" column="REPORT_MNO"/>
		<result property="bStatus" column="B_STATUS"/>
	</resultMap>
	
	<!-- 고객센터 FAQ 전체 게시글 수 조회용 쿼리문 -->
	<select id="selectFListCount" resultType="_int">
		SELECT COUNT(*)
		FROM V_FAQBOARD
		WHERE B_STATUS = 400
	</select>
	
	<!-- 고객센터 FAQ 조회용 쿼리문 -->
	<select id="selectFList" resultMap="boardResultSet">
		SELECT FNO, BTITLE, BCONTENT
		FROM V_FAQBOARD
		WHERE B_STATUS = 400
		ORDER BY FNO DESC
	</select>
	
	<!-- 고객센터 FAQ 조회수 증가용 쿼리문 -->
	<!-- <update id="updateFCount" parameterType="_int">
	
	</update> -->
	
	<!-- 고객센터 공지사항 게시글 수 조회용 쿼리문 -->
	<select id="selectNListCount" resultType="_int">
		SELECT COUNT(*)
		FROM V_SNOTICEBOARD
		WHERE B_STATUS = 401
	</select>
	<!-- 고객센터 공지사항 조회용 쿼리문 -->
	<select id="selectNList" resultMap="boardResultSet">
		SELECT SNNO, BTITLE, BCONTENT, WRITTEN_DATE, BCOUNT
		FROM V_SNOTICEBOARD
		WHERE B_STATUS = 401
		ORDER BY SNNO DESC
	</select>
	<!-- 고객센터 공지사항 조회수 증가용 쿼리문 -->
	<!-- <update id="updateNCount" parameterType="_int">
	
	</update> -->
	
	<!-- 구인구직 공지사항 INSERT -->
	<insert id="insertJobNotice" parameterType="Board">
		INSERT INTO 
		BOARD(BNO,		 BTITLE,   BCONTENT,   WRITTEN_DATE,MODIFY_DATE,BCOUNT,   BTYPE,   BWRITER,B_STATUS) VALUES
		(SEQ_BNO.NEXTVAL,#{btitle},#{bcontent},SYSDATE,		SYSDATE,	DEFAULT,  #{btype},#{bwriter},1)
	</insert>
	<!-- 구인구직 공지사항 목록 조회 -->
	<select id="selectListJobNotice" resultMap="boardResultSet">
		SELECT * 
		FROM BOARD
		WHERE BTYPE='구인구직공지'
		AND B_STATUS = '1'
	</select>
	<!-- 구인구직 공지사항 상세조회 -->
	<select id="selectOneJobNotice" resultMap="boardResultSet">
		SELECT * 
		FROM BOARD
		WHERE BTYPE='구인구직공지'
		AND B_STATUS = '1'
		AND BNO = #{bno}
	</select>
	<!-- 게시물 조회수 증가용 -->
	<update id="updateBoardCount" parameterType="_int">
		UPDATE BOARD SET BCOUNT = (SELECT BCOUNT FROM BOARD WHERE BNO = #{bno}) + 1
		WHERE BNO = #{bno}
	</update>
	<!-- 게시물 갯수 조회용 -->
	<select id="selectListCount" resultType="_int">
		SELECT COUNT(*)
		FROM BOARD
		WHERE B_STATUS = '1'
	</select>
	
	<!-- 페이징 모듈화 테스트 -->
	<!-- 2. ROWNUM Query -->
    <select id="selectPaging" parameterType="PagingVo" resultType="Board">
        SELECT *
        FROM (    SELECT ROWNUM RNUM, P.*
                FROM (    SELECT *
                        FROM BOARD
                        ORDER BY WRITTEN_DATE DESC ) P )
        WHERE RNUM BETWEEN #{start} AND #{last}
    </select>
    <!-- 2. Total Query -->
    <select id="selectTotalPaging" resultType="_int">
        SELECT COUNT(*)
        FROM BOARD
    </select>
	
</mapper>